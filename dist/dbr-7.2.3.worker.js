'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(e){var a=0;return function(){return a<e.length?{done:!1,value:e[a++]}:{done:!0}}};$jscomp.arrayIterator=function(e){return{next:$jscomp.arrayIteratorImpl(e)}};$jscomp.makeIterator=function(e){var a="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return a?a.call(e):$jscomp.arrayIterator(e)};
$jscomp.getGlobal=function(e){return"undefined"!=typeof window&&window===e?e:"undefined"!=typeof global&&null!=global?global:e};$jscomp.global=$jscomp.getGlobal(this);$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,a,d){e!=Array.prototype&&e!=Object.prototype&&(e[a]=d.value)};
$jscomp.polyfill=function(e,a,d,m){if(a){d=$jscomp.global;e=e.split(".");for(m=0;m<e.length-1;m++){var l=e[m];l in d||(d[l]={});d=d[l]}e=e[e.length-1];m=d[e];a=a(m);a!=m&&null!=a&&$jscomp.defineProperty(d,e,{configurable:!0,writable:!0,value:a})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(e){function a(){this.batch_=null}function d(e){return e instanceof l?e:new l(function(a,h){a(e)})}if(e&&!$jscomp.FORCE_POLYFILL_PROMISE)return e;a.prototype.asyncExecute=function(e){if(null==this.batch_){this.batch_=[];var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})}this.batch_.push(e)};var m=$jscomp.global.setTimeout;a.prototype.asyncExecuteFunction=function(e){m(e,0)};a.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var e=
this.batch_;this.batch_=[];for(var a=0;a<e.length;++a){var h=e[a];e[a]=null;try{h()}catch(r){this.asyncThrow_(r)}}}this.batch_=null};a.prototype.asyncThrow_=function(e){this.asyncExecuteFunction(function(){throw e;})};var l=function(e){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var a=this.createResolveAndReject_();try{e(a.resolve,a.reject)}catch(h){a.reject(h)}};l.prototype.createResolveAndReject_=function(){function e(e){return function(c){h||(h=!0,e.call(a,c))}}var a=this,h=!1;
return{resolve:e(this.resolveTo_),reject:e(this.reject_)}};l.prototype.resolveTo_=function(e){if(e===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof l)this.settleSameAsPromise_(e);else{a:switch(typeof e){case "object":var a=null!=e;break a;case "function":a=!0;break a;default:a=!1}a?this.resolveToNonPromiseObj_(e):this.fulfill_(e)}};l.prototype.resolveToNonPromiseObj_=function(e){var a=void 0;try{a=e.then}catch(h){this.reject_(h);return}"function"==typeof a?
this.settleSameAsThenable_(a,e):this.fulfill_(e)};l.prototype.reject_=function(e){this.settle_(2,e)};l.prototype.fulfill_=function(e){this.settle_(1,e)};l.prototype.settle_=function(e,a){if(0!=this.state_)throw Error("Cannot settle("+e+", "+a+"): Promise already settled in state"+this.state_);this.state_=e;this.result_=a;this.executeOnSettledCallbacks_()};l.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var e=0;e<this.onSettledCallbacks_.length;++e)k.asyncExecute(this.onSettledCallbacks_[e]);
this.onSettledCallbacks_=null}};var k=new a;l.prototype.settleSameAsPromise_=function(e){var a=this.createResolveAndReject_();e.callWhenSettled_(a.resolve,a.reject)};l.prototype.settleSameAsThenable_=function(e,a){var c=this.createResolveAndReject_();try{e.call(a,c.resolve,c.reject)}catch(r){c.reject(r)}};l.prototype.then=function(e,a){function c(e,a){return"function"==typeof e?function(a){try{d(e(a))}catch(E){k(E)}}:a}var d,k,m=new l(function(e,a){d=e;k=a});this.callWhenSettled_(c(e,d),c(a,k));return m};
l.prototype.catch=function(e){return this.then(void 0,e)};l.prototype.callWhenSettled_=function(e,a){function c(){switch(d.state_){case 1:e(d.result_);break;case 2:a(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?k.asyncExecute(c):this.onSettledCallbacks_.push(c)};l.resolve=d;l.reject=function(e){return new l(function(a,d){d(e)})};l.race=function(e){return new l(function(a,h){for(var c=$jscomp.makeIterator(e),l=c.next();!l.done;l=c.next())d(l.value).callWhenSettled_(a,
h)})};l.all=function(e){var a=$jscomp.makeIterator(e),h=a.next();return h.done?d([]):new l(function(e,c){function l(a){return function(c){k[a]=c;m--;0==m&&e(k)}}var k=[],m=0;do k.push(void 0),m++,d(h.value).callWhenSettled_(l(k.length-1),c),h=a.next();while(!h.done)})};return l},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(e,a){this.$jscomp$symbol$id_=e;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:a})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function e(d){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(d||"")+"_"+a++,d)}var a=0;return e}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var e=$jscomp.global.Symbol.iterator;e||(e=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[e]&&$jscomp.defineProperty(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var e=$jscomp.global.Symbol.asyncIterator;e||(e=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(e){$jscomp.initSymbolIterator();e={next:e};e[$jscomp.global.Symbol.iterator]=function(){return this};return e};$jscomp.underscoreProtoCanBeSet=function(){var e={a:!0},a={};try{return a.__proto__=e,a.a}catch(d){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(e,a){e.__proto__=a;if(e.__proto__!==a)throw new TypeError(e+" is not extensible");return e}:null;$jscomp.generator={};$jscomp.generator.ensureIteratorResultIsObject_=function(e){if(!(e instanceof Object))throw new TypeError("Iterator result "+e+" is not an object");};
$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};
$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(e){this.yieldResult=e};$jscomp.generator.Context.prototype.throw_=function(e){this.abruptCompletion_={exception:e,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(e){this.abruptCompletion_={return:e};this.nextAddress=this.finallyAddress_};
$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(e){this.abruptCompletion_={jumpTo:e};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(e,a){this.nextAddress=a;return{value:e}};$jscomp.generator.Context.prototype.yieldAll=function(e,a){e=$jscomp.makeIterator(e);var d=e.next();$jscomp.generator.ensureIteratorResultIsObject_(d);if(d.done)this.yieldResult=d.value,this.nextAddress=a;else return this.yieldAllIterator_=e,this.yield(d.value,a)};
$jscomp.generator.Context.prototype.jumpTo=function(e){this.nextAddress=e};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(e,a){this.catchAddress_=e;void 0!=a&&(this.finallyAddress_=a)};$jscomp.generator.Context.prototype.setFinallyBlock=function(e){this.catchAddress_=0;this.finallyAddress_=e||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(e,a){this.nextAddress=e;this.catchAddress_=a||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(e){this.catchAddress_=e||0;e=this.abruptCompletion_.exception;this.abruptCompletion_=null;return e};$jscomp.generator.Context.prototype.enterFinallyBlock=function(e,a,d){d?this.finallyContexts_[d]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=e||0;this.finallyAddress_=a||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(e,a){a=this.finallyContexts_.splice(a||0)[0];if(a=this.abruptCompletion_=this.abruptCompletion_||a){if(a.isException)return this.jumpToErrorHandler_();void 0!=a.jumpTo&&this.finallyAddress_<a.jumpTo?(this.nextAddress=a.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=e};$jscomp.generator.Context.prototype.forIn=function(e){return new $jscomp.generator.Context.PropertyIterator(e)};
$jscomp.generator.Context.PropertyIterator=function(e){this.object_=e;this.properties_=[];for(var a in e)this.properties_.push(a);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var e=this.properties_.pop();if(e in this.object_)return e}return null};$jscomp.generator.Engine_=function(e){this.context_=new $jscomp.generator.Context;this.program_=e};
$jscomp.generator.Engine_.prototype.next_=function(e){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,e,this.context_.next_);this.context_.next_(e);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(e){this.context_.start_();var a=this.context_.yieldAllIterator_;if(a)return this.yieldAllStep_("return"in a?a["return"]:function(e){return{value:e,done:!0}},e,this.context_.return);this.context_.return(e);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(e){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],e,this.context_.next_);this.context_.throw_(e);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(e,a,d){try{var m=e.call(this.context_.yieldAllIterator_,a);$jscomp.generator.ensureIteratorResultIsObject_(m);if(!m.done)return this.context_.stop_(),m;var l=m.value}catch(k){return this.context_.yieldAllIterator_=null,this.context_.throw_(k),this.nextStep_()}this.context_.yieldAllIterator_=null;d.call(this.context_,l);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var e=this.program_(this.context_);if(e)return this.context_.stop_(),{value:e.value,done:!1}}catch(a){this.context_.yieldResult=void 0,this.context_.throw_(a)}this.context_.stop_();if(this.context_.abruptCompletion_){e=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(e.isException)throw e.exception;return{value:e.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(e){this.next=function(a){return e.next_(a)};this.throw=function(a){return e.throw_(a)};this.return=function(a){return e.return_(a)};$jscomp.initSymbolIterator();this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(e,a){a=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(a));$jscomp.setPrototypeOf&&$jscomp.setPrototypeOf(a,e.prototype);return a};
$jscomp.asyncExecutePromiseGenerator=function(e){function a(a){return e.next(a)}function d(a){return e.throw(a)}return new Promise(function(m,l){function k(e){e.done?m(e.value):Promise.resolve(e.value).then(a,d).then(k,l)}k(e.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(e){return $jscomp.asyncExecutePromiseGenerator(e())};$jscomp.asyncExecutePromiseGeneratorProgram=function(e){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(e)))};
const dbrBNode=!!("object"==typeof global&&global.process&&global.process.release&&global.process.release.name);let worker_threads;dbrBNode&&(worker_threads=require("worker_threads"));let parentPort=dbrBNode?worker_threads.parentPort:self,dbrBWasmDebug,dbrEngineResourcePath,dbrVersion,dbrProductKeys,dbrBRuntimeKeys,dbrDomain,dbrBNewDevice=!1,dbrBUseFullFeature=!1,dbrUUID,dbrLicenseServer="https://dbrjsauth.dynamsoft.com/v2/",dbrPromiseGetLicense,dbrLicenseInfo,dbrPromisePostConsumption=Promise.resolve();
dbrBNode||!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).localforage=e()}(function(){return function l(a,d,m){function k(c,r){if(!d[c]){if(!a[c]){var h="function"==typeof require&&require;if(!r&&h)return h(c,!0);if(t)return t(c,!0);r=Error("Cannot find module '"+c+"'");throw r.code="MODULE_NOT_FOUND",r;}r=
d[c]={exports:{}};a[c][0].call(r.exports,function(d){return k(a[c][1][d]||d)},r,r.exports,l,a,d,m)}return d[c].exports}for(var t="function"==typeof require&&require,c=0;c<m.length;c++)k(m[c]);return k}({1:[function(a,d,m){(function(a){function k(){z=!0;for(var a,c,d=q.length;d;){c=q;q=[];for(a=-1;++a<d;)c[a]();d=q.length}z=!1}var l=a.MutationObserver||a.WebKitMutationObserver;if(l){var c=0;l=new l(k);var h=a.document.createTextNode("");l.observe(h,{characterData:!0});var m=function(){h.data=c=++c%
2}}else if(a.setImmediate||void 0===a.MessageChannel)m="document"in a&&"onreadystatechange"in a.document.createElement("script")?function(){var c=a.document.createElement("script");c.onreadystatechange=function(){k();c.onreadystatechange=null;c.parentNode.removeChild(c);c=null};a.document.documentElement.appendChild(c)}:function(){setTimeout(k,0)};else{var w=new a.MessageChannel;w.port1.onmessage=k;m=function(){w.port2.postMessage(0)}}var z,q=[];d.exports=function(a){1!==q.push(a)||z||m()}}).call(this,
"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(a,d,m){function l(){}function k(a){if("function"!=typeof a)throw new TypeError("resolver must be a function");this.state=E;this.queue=[];this.outcome=void 0;a!==l&&r(this,a)}function t(a,c,d){this.promise=a;"function"==typeof c&&(this.onFulfilled=c,this.callFulfilled=this.otherCallFulfilled);"function"==typeof d&&(this.onRejected=d,this.callRejected=this.otherCallRejected)}function c(a,
c,d){z(function(){try{var h=c(d)}catch(x){return q.reject(a,x)}h===a?q.reject(a,new TypeError("Cannot resolve promise with itself")):q.resolve(a,h)})}function h(a){var c=a&&a.then;if(a&&("object"==typeof a||"function"==typeof a)&&"function"==typeof c)return function(){c.apply(a,arguments)}}function r(a,c){function d(c){k||(k=!0,q.reject(a,c))}function h(c){k||(k=!0,q.resolve(a,c))}var k=!1,l=w(function(){c(h,d)});"error"===l.status&&d(l.value)}function w(a,c){var d={};try{d.value=a(c),d.status="success"}catch(O){d.status=
"error",d.value=O}return d}var z=a(1),q={},F=["REJECTED"],y=["FULFILLED"],E=["PENDING"];d.exports=k;k.prototype.catch=function(a){return this.then(null,a)};k.prototype.then=function(a,d){if("function"!=typeof a&&this.state===y||"function"!=typeof d&&this.state===F)return this;var h=new this.constructor(l);this.state!==E?c(h,this.state===y?a:d,this.outcome):this.queue.push(new t(h,a,d));return h};t.prototype.callFulfilled=function(a){q.resolve(this.promise,a)};t.prototype.otherCallFulfilled=function(a){c(this.promise,
this.onFulfilled,a)};t.prototype.callRejected=function(a){q.reject(this.promise,a)};t.prototype.otherCallRejected=function(a){c(this.promise,this.onRejected,a)};q.resolve=function(a,c){var d=w(h,c);if("error"===d.status)return q.reject(a,d.value);if(d=d.value)r(a,d);else{a.state=y;a.outcome=c;d=-1;for(var k=a.queue.length;++d<k;)a.queue[d].callFulfilled(c)}return a};q.reject=function(a,c){a.state=F;a.outcome=c;for(var d=-1,h=a.queue.length;++d<h;)a.queue[d].callRejected(c);return a};k.resolve=function(a){return a instanceof
this?a:q.resolve(new this(l),a)};k.reject=function(a){var c=new this(l);return q.reject(c,a)};k.all=function(a){function c(a,c){d.resolve(a).then(function(a){m[c]=a;++t!==h||k||(k=!0,q.resolve(w,m))},function(a){k||(k=!0,q.reject(w,a))})}var d=this;if("[object Array]"!==Object.prototype.toString.call(a))return this.reject(new TypeError("must be an array"));var h=a.length,k=!1;if(!h)return this.resolve([]);for(var m=Array(h),t=0,r=-1,w=new this(l);++r<h;)c(a[r],r);return w};k.race=function(a){function c(a){d.resolve(a).then(function(a){k||
(k=!0,q.resolve(t,a))},function(a){k||(k=!0,q.reject(t,a))})}var d=this;if("[object Array]"!==Object.prototype.toString.call(a))return this.reject(new TypeError("must be an array"));var h=a.length,k=!1;if(!h)return this.resolve([]);for(var m=-1,t=new this(l);++m<h;)c(a[m]);return t}},{1:1}],3:[function(a,d,m){d="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};"function"!=typeof d.Promise&&(d.Promise=a(2))},{2:2}],4:[function(a,d,m){function l(b,
a){b=b||[];a=a||{};try{return new Blob(b,a)}catch(C){if("TypeError"!==C.name)throw C;for(var f=new ("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),u=0;u<b.length;u+=1)f.append(b[u]);return f.getBlob(a.type)}}function k(b,a){a&&b.then(function(b){a(null,b)},function(b){a(b)})}function t(b,a,g){"function"==typeof a&&b.then(a);"function"==typeof g&&b.catch(g)}function c(b){return"string"!=
typeof b&&(console.warn(b+" used as a key, but it is not a string."),b=String(b)),b}function h(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}function r(b){return(new p(function(a){var f=b.transaction(Q,L),u=l([""]);f.objectStore(Q).put(u,"key");f.onabort=function(b){b.preventDefault();b.stopPropagation();a(!1)};f.oncomplete=function(){var b=navigator.userAgent.match(/Chrome\/(\d+)/),f=navigator.userAgent.match(/Edge\//);a(f||!b||43<=parseInt(b[1],
10))}})).catch(function(){return!1})}function w(b){return"boolean"==typeof R?p.resolve(R):r(b).then(function(b){return R=b})}function z(b){b=v[b.name];var a={};a.promise=new p(function(b,f){a.resolve=b;a.reject=f});b.deferredOperations.push(a);b.dbReady?b.dbReady=b.dbReady.then(function(){return a.promise}):b.dbReady=a.promise}function q(b){if(b=v[b.name].deferredOperations.pop())return b.resolve(),b.promise}function F(b,a){if(b=v[b.name].deferredOperations.pop())return b.reject(a),b.promise}function y(b,
a){return new p(function(f,u){if(v[b.name]=v[b.name]||Z(),b.db){if(!a)return f(b.db);z(b);b.db.close()}var g=[b.name];a&&g.push(b.version);var c=I.open.apply(I,g);a&&(c.onupgradeneeded=function(a){var f=c.result;try{f.createObjectStore(b.storeName),1>=a.oldVersion&&f.createObjectStore(Q)}catch(A){if("ConstraintError"!==A.name)throw A;console.warn('The database "'+b.name+'" has been upgraded from version '+a.oldVersion+" to version "+a.newVersion+', but the storage "'+b.storeName+'" already exists.')}});
c.onerror=function(b){b.preventDefault();u(c.error)};c.onsuccess=function(){f(c.result);q(b)}})}function E(b,a){if(!b.db)return!0;var f=!b.db.objectStoreNames.contains(b.storeName),c=b.version>b.db.version;return(b.version<b.db.version&&(b.version!==a&&console.warn('The database "'+b.name+"\" can't be downgraded from version "+b.db.version+" to version "+b.version+"."),b.version=b.db.version),c||f)?(f&&(a=b.db.version+1,a>b.version&&(b.version=a)),!0):!1}function ka(b){return new p(function(a,g){var f=
new FileReader;f.onerror=g;f.onloadend=function(f){f=btoa(f.target.result||"");a({__local_forage_encoded_blob:!0,data:f,type:b.type})};f.readAsBinaryString(b)})}function X(b){for(var a=atob(b.data),g=a.length,c=new ArrayBuffer(g),d=new Uint8Array(c),n=0;n<g;n++)d[n]=a.charCodeAt(n);return l([c],{type:b.type})}function la(b){var a=this,g=a._initReady().then(function(){var b=v[a._dbInfo.name];if(b&&b.dbReady)return b.dbReady});return t(g,b,b),g}function O(b){z(b);for(var a=v[b.name],g=a.forages,c=0;c<
g.length;c++){var d=g[c];d._dbInfo.db&&(d._dbInfo.db.close(),d._dbInfo.db=null)}return b.db=null,y(b,!1).then(function(a){return b.db=a,E(b)?y(b,!0):a}).then(function(f){b.db=a.db=f;for(var c=0;c<g.length;c++)g[c]._dbInfo.db=f}).catch(function(a){throw F(b,a),a;})}function x(b,a,g,c){void 0===c&&(c=1);try{var f=b.db.transaction(b.storeName,a);g(null,f)}catch(n){if(0<c&&(!b.db||"InvalidStateError"===n.name||"NotFoundError"===n.name))return p.resolve().then(function(){if(!b.db||"NotFoundError"===n.name&&
!b.db.objectStoreNames.contains(b.storeName)&&b.version<=b.db.version)return b.db&&(b.version=b.db.version+1),y(b,!0)}).then(function(){return O(b).then(function(){x(b,a,g,c-1)})}).catch(g);g(n)}}function Z(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Y(b){var a=.75*b.length;var g=b.length,c=0;"="===b[b.length-1]&&(a--,"="===b[b.length-2]&&a--);var d=new ArrayBuffer(a),n=new Uint8Array(d);for(a=0;a<g;a+=4){var h=D.indexOf(b[a]);var da=D.indexOf(b[a+1]);var A=D.indexOf(b[a+
2]);var k=D.indexOf(b[a+3]);n[c++]=h<<2|da>>4;n[c++]=(15&da)<<4|A>>2;n[c++]=(3&A)<<6|63&k}return d}function P(a){var b=new Uint8Array(a),g="";for(a=0;a<b.length;a+=3)g+=D[b[a]>>2],g+=D[(3&b[a])<<4|b[a+1]>>4],g+=D[(15&b[a+1])<<2|b[a+2]>>6],g+=D[63&b[a+2]];return 2==b.length%3?g=g.substring(0,g.length-1)+"=":1==b.length%3&&(g=g.substring(0,g.length-2)+"=="),g}function ba(a,f,g,c){a.executeSql("CREATE TABLE IF NOT EXISTS "+f.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],g,c)}function B(a,
f,g,c,d,n){a.executeSql(g,c,d,function(a,b){b.code===b.SYNTAX_ERR?a.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[f.storeName],function(a,u){u.rows.length?n(a,b):ba(a,f,function(){a.executeSql(g,c,d,n)},n)},n):n(a,b)},n)}function aa(a,f,g,d){var b=this;a=c(a);var n=new p(function(c,n){b.ready().then(function(){void 0===f&&(f=null);var u=f,C=b._dbInfo;C.serializer.serialize(f,function(f,h){h?n(h):C.db.transaction(function(b){B(b,C,"INSERT OR REPLACE INTO "+C.storeName+
" (key, value) VALUES (?, ?)",[a,f],function(){c(u)},function(a,b){n(b)})},function(f){if(f.code===f.QUOTA_ERR){if(0<d)return void c(aa.apply(b,[a,u,g,d-1]));n(f)}})})}).catch(n)});return k(n,g),n}function ma(a){return new p(function(b,g){a.transaction(function(f){f.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(f,g){f=[];for(var c=0;c<g.rows.length;c++)f.push(g.rows.item(c).name);b({db:a,storeNames:f})},function(a,b){g(b)})},function(a){g(a)})})}
function ea(a,f){var b=a.name+"/";return a.storeName!==f.storeName&&(b+=a.storeName+"/"),b}function na(a,f){a[f]=function(){var b=arguments;return a.ready().then(function(){return a[f].apply(a,b)})}}function U(){for(var a=1;a<arguments.length;a++){var f=arguments[a];if(f)for(var g in f)f.hasOwnProperty(g)&&(fa(f[g])?arguments[0][g]=f[g].slice():arguments[0][g]=f[g])}return arguments[0]}var oa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&
"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},I=function(){if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}();"undefined"==typeof Promise&&a(3);var p=Promise,Q="local-forage-detect-blob-support",R=void 0,v={},pa=Object.prototype.toString,
L="readwrite";a={_driver:"asyncStorage",_initStorage:function(a){function b(){return p.resolve()}var g=this,c={db:null};if(a)for(var d in a)c[d]=a[d];var n=v[c.name];n||(n=Z(),v[c.name]=n);n.forages.push(g);g._initReady||(g._initReady=g.ready,g.ready=la);a=[];for(d=0;d<n.forages.length;d++){var h=n.forages[d];h!==g&&a.push(h._initReady().catch(b))}var k=n.forages.slice(0);return p.all(a).then(function(){return c.db=n.db,y(c,!1)}).then(function(a){return c.db=a,E(c,g._defaultConfig.version)?y(c,!0):
a}).then(function(a){c.db=n.db=a;g._dbInfo=c;for(a=0;a<k.length;a++){var b=k[a];b!==g&&(b._dbInfo.db=c.db,b._dbInfo.version=c.version)}})},_support:function(){try{if(!I)return!1;var a="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),f="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!a||f)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(g){return!1}}(),
iterate:function(a,f){var b=this,c=new p(function(f,c){b.ready().then(function(){x(b._dbInfo,"readonly",function(g,d){if(g)return c(g);try{var n=d.objectStore(b._dbInfo.storeName).openCursor(),u=1;n.onsuccess=function(){var b=n.result;if(b){var c=b.value;c&&c.__local_forage_encoded_blob&&(c=X(c));c=a(c,b.key,u++);void 0!==c?f(c):b.continue()}else f()};n.onerror=function(){c(n.error)}}catch(S){c(S)}})}).catch(c)});return k(c,f),c},getItem:function(a,f){var b=this;a=c(a);var d=new p(function(c,f){b.ready().then(function(){x(b._dbInfo,
"readonly",function(g,d){if(g)return f(g);try{var n=d.objectStore(b._dbInfo.storeName).get(a);n.onsuccess=function(){var a=n.result;void 0===a&&(a=null);a&&a.__local_forage_encoded_blob&&(a=X(a));c(a)};n.onerror=function(){f(n.error)}}catch(J){f(J)}})}).catch(f)});return k(d,f),d},setItem:function(a,f,g){var b=this;a=c(a);var d=new p(function(c,g){var d;b.ready().then(function(){return d=b._dbInfo,"[object Blob]"===pa.call(f)?w(d.db).then(function(a){return a?f:ka(f)}):f}).then(function(f){x(b._dbInfo,
L,function(d,n){if(d)return g(d);try{var u=n.objectStore(b._dbInfo.storeName);null===f&&(f=void 0);var h=u.put(f,a);n.oncomplete=function(){void 0===f&&(f=null);c(f)};n.onabort=n.onerror=function(){g(h.error?h.error:h.transaction.error)}}catch(T){g(T)}})}).catch(g)});return k(d,g),d},removeItem:function(a,f){var b=this;a=c(a);var d=new p(function(c,f){b.ready().then(function(){x(b._dbInfo,L,function(g,d){if(g)return f(g);try{var n=d.objectStore(b._dbInfo.storeName).delete(a);d.oncomplete=function(){c()};
d.onerror=function(){f(n.error)};d.onabort=function(){f(n.error?n.error:n.transaction.error)}}catch(J){f(J)}})}).catch(f)});return k(d,f),d},clear:function(a){var b=this,c=new p(function(a,c){b.ready().then(function(){x(b._dbInfo,L,function(f,g){if(f)return c(f);try{var d=g.objectStore(b._dbInfo.storeName).clear();g.oncomplete=function(){a()};g.onabort=g.onerror=function(){c(d.error?d.error:d.transaction.error)}}catch(A){c(A)}})}).catch(c)});return k(c,a),c},length:function(a){var b=this,c=new p(function(a,
c){b.ready().then(function(){x(b._dbInfo,"readonly",function(f,g){if(f)return c(f);try{var d=g.objectStore(b._dbInfo.storeName).count();d.onsuccess=function(){a(d.result)};d.onerror=function(){c(d.error)}}catch(A){c(A)}})}).catch(c)});return k(c,a),c},key:function(a,c){var b=this,f=new p(function(c,f){if(0>a)return void c(null);b.ready().then(function(){x(b._dbInfo,"readonly",function(g,d){if(g)return f(g);try{var n=!1,h=d.objectStore(b._dbInfo.storeName).openCursor();h.onsuccess=function(){var b=
h.result;if(!b)return void c(null);0===a?c(b.key):n?c(b.key):(n=!0,b.advance(a))};h.onerror=function(){f(h.error)}}catch(S){f(S)}})}).catch(f)});return k(f,c),f},keys:function(a){var b=this,c=new p(function(a,c){b.ready().then(function(){x(b._dbInfo,"readonly",function(f,g){if(f)return c(f);try{var d=g.objectStore(b._dbInfo.storeName).openCursor(),n=[];d.onsuccess=function(){var b=d.result;if(!b)return void a(n);n.push(b.key);b.continue()};d.onerror=function(){c(d.error)}}catch(J){c(J)}})}).catch(c)});
return k(c,a),c},dropInstance:function(a,c){c=h.apply(this,arguments);var b=this.config();a="function"!=typeof a&&a||{};a.name||(a.name=a.name||b.name,a.storeName=a.storeName||b.storeName);a.name?(b=a.name===b.name&&this._dbInfo.db?p.resolve(this._dbInfo.db):y(a,!1).then(function(b){var c=v[a.name],f=c.forages;c.db=b;for(c=0;c<f.length;c++)f[c]._dbInfo.db=b;return b}),b=a.storeName?b.then(function(b){if(b.objectStoreNames.contains(a.storeName)){var c=b.version+1;z(a);var f=v[a.name],g=f.forages;b.close();
for(b=0;b<g.length;b++){var d=g[b];d._dbInfo.db=null;d._dbInfo.version=c}return(new p(function(b,f){var g=I.open(a.name,c);g.onerror=function(a){g.result.close();f(a)};g.onupgradeneeded=function(){g.result.deleteObjectStore(a.storeName)};g.onsuccess=function(){var a=g.result;a.close();b(a)}})).then(function(a){f.db=a;for(var b=0;b<g.length;b++){var c=g[b];c._dbInfo.db=a;q(c._dbInfo)}}).catch(function(b){throw(F(a,b)||p.resolve()).catch(function(){}),b;})}}):b.then(function(b){z(a);var c=v[a.name],
f=c.forages;b.close();for(b=0;b<f.length;b++)f[b]._dbInfo.db=null;return(new p(function(b,c){var f=I.deleteDatabase(a.name);f.onerror=f.onblocked=function(a){var b=f.result;b&&b.close();c(a)};f.onsuccess=function(){var a=f.result;a&&a.close();b(a)}})).then(function(a){c.db=a;for(a=0;a<f.length;a++)q(f[a]._dbInfo)}).catch(function(b){throw(F(a,b)||p.resolve()).catch(function(){}),b;})})):b=p.reject("Invalid arguments");return k(b,c),b}};var D="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",
ha=/^~~local_forage_type~([^~]+)~/,ia=Object.prototype.toString,V={serialize:function(a,c){var b="";if(a&&(b=ia.call(a)),a&&("[object ArrayBuffer]"===b||a.buffer&&"[object ArrayBuffer]"===ia.call(a.buffer))){var f,d="__lfsc__:";a instanceof ArrayBuffer?(f=a,d+="arbf"):(f=a.buffer,"[object Int8Array]"===b?d+="si08":"[object Uint8Array]"===b?d+="ui08":"[object Uint8ClampedArray]"===b?d+="uic8":"[object Int16Array]"===b?d+="si16":"[object Uint16Array]"===b?d+="ur16":"[object Int32Array]"===b?d+="si32":
"[object Uint32Array]"===b?d+="ui32":"[object Float32Array]"===b?d+="fl32":"[object Float64Array]"===b?d+="fl64":c(Error("Failed to get type for BinaryArray")));c(d+P(f))}else if("[object Blob]"===b)b=new FileReader,b.onload=function(){var b="~~local_forage_type~"+a.type+"~"+P(this.result);c("__lfsc__:blob"+b)},b.readAsArrayBuffer(a);else try{c(JSON.stringify(a))}catch(n){console.error("Couldn't convert value into a JSON string: ",a),c(null,n)}},deserialize:function(a){if("__lfsc__:"!==a.substring(0,
9))return JSON.parse(a);var b=a.substring(13);a=a.substring(9,13);if("blob"===a&&ha.test(b)){var c=b.match(ha);var d=c[1];b=b.substring(c[0].length)}b=Y(b);switch(a){case "arbf":return b;case "blob":return l([b],{type:d});case "si08":return new Int8Array(b);case "ui08":return new Uint8Array(b);case "uic8":return new Uint8ClampedArray(b);case "si16":return new Int16Array(b);case "ur16":return new Uint16Array(b);case "si32":return new Int32Array(b);case "ui32":return new Uint32Array(b);case "fl32":return new Float32Array(b);
case "fl64":return new Float64Array(b);default:throw Error("Unkown type: "+a);}},stringToBuffer:Y,bufferToString:P};m={_driver:"webSQLStorage",_initStorage:function(a){var b=this,c={db:null};if(a)for(var d in a)c[d]="string"!=typeof a[d]?a[d].toString():a[d];a=new p(function(a,f){try{c.db=openDatabase(c.name,String(c.version),c.description,c.size)}catch(ca){return f(ca)}c.db.transaction(function(d){ba(d,c,function(){b._dbInfo=c;a()},function(a,b){f(b)})},f)});return c.serializer=V,a},_support:"function"==
typeof openDatabase,iterate:function(a,c){var b=this,f=new p(function(c,f){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){B(b,d,"SELECT * FROM "+d.storeName,[],function(b,f){b=f.rows;f=b.length;for(var g=0;g<f;g++){var n=b.item(g),h=n.value;if(h&&(h=d.serializer.deserialize(h)),void 0!==(h=a(h,n.key,g+1)))return void c(h)}c()},function(a,b){f(b)})})}).catch(f)});return k(f,c),f},getItem:function(a,f){var b=this;a=c(a);var d=new p(function(c,f){b.ready().then(function(){var d=
b._dbInfo;d.db.transaction(function(b){B(b,d,"SELECT * FROM "+d.storeName+" WHERE key = ? LIMIT 1",[a],function(a,b){(a=b.rows.length?b.rows.item(0).value:null)&&(a=d.serializer.deserialize(a));c(a)},function(a,b){f(b)})})}).catch(f)});return k(d,f),d},setItem:function(a,c,d){return aa.apply(this,[a,c,d,1])},removeItem:function(a,f){var b=this;a=c(a);var d=new p(function(c,f){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){B(b,d,"DELETE FROM "+d.storeName+" WHERE key = ?",[a],
function(){c()},function(a,b){f(b)})})}).catch(f)});return k(d,f),d},clear:function(a){var b=this,c=new p(function(a,c){b.ready().then(function(){var f=b._dbInfo;f.db.transaction(function(b){B(b,f,"DELETE FROM "+f.storeName,[],function(){a()},function(a,b){c(b)})})}).catch(c)});return k(c,a),c},length:function(a){var b=this,c=new p(function(a,c){b.ready().then(function(){var f=b._dbInfo;f.db.transaction(function(b){B(b,f,"SELECT COUNT(key) as c FROM "+f.storeName,[],function(b,c){b=c.rows.item(0).c;
a(b)},function(a,b){c(b)})})}).catch(c)});return k(c,a),c},key:function(a,c){var b=this,f=new p(function(c,f){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){B(b,d,"SELECT key FROM "+d.storeName+" WHERE id = ? LIMIT 1",[a+1],function(a,b){a=b.rows.length?b.rows.item(0).key:null;c(a)},function(a,b){f(b)})})}).catch(f)});return k(f,c),f},keys:function(a){var b=this,c=new p(function(a,c){b.ready().then(function(){var f=b._dbInfo;f.db.transaction(function(b){B(b,f,"SELECT key FROM "+
f.storeName,[],function(b,c){b=[];for(var f=0;f<c.rows.length;f++)b.push(c.rows.item(f).key);a(b)},function(a,b){c(b)})})}).catch(c)});return k(c,a),c},dropInstance:function(a,c){c=h.apply(this,arguments);var b=this.config();a="function"!=typeof a&&a||{};a.name||(a.name=a.name||b.name,a.storeName=a.storeName||b.storeName);var f,d=this;return f=a.name?(new p(function(c){var f=a.name===b.name?d._dbInfo.db:openDatabase(a.name,"","",0);c(a.storeName?{db:f,storeNames:[a.storeName]}:ma(f))})).then(function(a){return new p(function(b,
c){a.db.transaction(function(f){function d(a){return new p(function(b,c){f.executeSql("DROP TABLE IF EXISTS "+a,[],function(){b()},function(a,b){c(b)})})}for(var g=[],h=0,n=a.storeNames.length;h<n;h++)g.push(d(a.storeNames[h]));p.all(g).then(function(){b()}).catch(function(a){c(a)})},function(a){c(a)})})}):p.reject("Invalid arguments"),k(f,c),f}};try{var G="undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(b){G=!1}var qa=function(a,c){for(var b=a.length,f=0;f<
b;){var d=a[f],h=c;if(d===h||"number"==typeof d&&"number"==typeof h&&isNaN(d)&&isNaN(h))return!0;f++}return!1},fa=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},K={},ja={},H={INDEXEDDB:a,WEBSQL:m,LOCALSTORAGE:{_driver:"localStorageWrapper",_initStorage:function(a){var b={};if(a)for(var c in a)b[c]=a[c];b.keyPrefix=ea(a,this._defaultConfig);try{var d=(localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1)}catch(C){d=
!0}return!d||0<localStorage.length?(this._dbInfo=b,b.serializer=V,p.resolve()):p.reject()},_support:G,iterate:function(a,c){var b=this,f=b.ready().then(function(){for(var c=b._dbInfo,f=c.keyPrefix,d=f.length,g=localStorage.length,h=1,k=0;k<g;k++){var m=localStorage.key(k);if(0===m.indexOf(f)){var l=localStorage.getItem(m);if(l&&(l=c.serializer.deserialize(l)),void 0!==(l=a(l,m.substring(d),h++)))return l}}});return k(f,c),f},getItem:function(a,f){var b=this;a=c(a);var d=b.ready().then(function(){var c=
b._dbInfo,f=localStorage.getItem(c.keyPrefix+a);return f&&(f=c.serializer.deserialize(f)),f});return k(d,f),d},setItem:function(a,f,d){var b=this;a=c(a);var g=b.ready().then(function(){void 0===f&&(f=null);var c=f;return new p(function(d,g){var h=b._dbInfo;h.serializer.serialize(f,function(b,f){if(f)g(f);else try{localStorage.setItem(h.keyPrefix+a,b),d(c)}catch(M){"QuotaExceededError"!==M.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==M.name||g(M),g(M)}})})});return k(g,d),g},removeItem:function(a,f){var b=
this;a=c(a);var d=b.ready().then(function(){localStorage.removeItem(b._dbInfo.keyPrefix+a)});return k(d,f),d},clear:function(a){var b=this,c=b.ready().then(function(){for(var a=b._dbInfo.keyPrefix,c=localStorage.length-1;0<=c;c--){var f=localStorage.key(c);0===f.indexOf(a)&&localStorage.removeItem(f)}});return k(c,a),c},length:function(a){var b=this.keys().then(function(a){return a.length});return k(b,a),b},key:function(a,c){var b=this,f=b.ready().then(function(){var c=b._dbInfo;try{var f=localStorage.key(a)}catch(ca){f=
null}return f&&(f=f.substring(c.keyPrefix.length)),f});return k(f,c),f},keys:function(a){var b=this,c=b.ready().then(function(){for(var a=b._dbInfo,c=localStorage.length,f=[],d=0;d<c;d++){var g=localStorage.key(d);0===g.indexOf(a.keyPrefix)&&f.push(g.substring(a.keyPrefix.length))}return f});return k(c,a),c},dropInstance:function(a,c){if(c=h.apply(this,arguments),a="function"!=typeof a&&a||{},!a.name){var b=this.config();a.name=a.name||b.name;a.storeName=a.storeName||b.storeName}var f,d=this;return f=
a.name?(new p(function(b){b(a.storeName?ea(a,d._defaultConfig):a.name+"/")})).then(function(a){for(var b=localStorage.length-1;0<=b;b--){var c=localStorage.key(b);0===c.indexOf(a)&&localStorage.removeItem(c)}}):p.reject("Invalid arguments"),k(f,c),f}}};G=[H.INDEXEDDB._driver,H.WEBSQL._driver,H.LOCALSTORAGE._driver];var N=["dropInstance"],W="clear getItem iterate key keys length removeItem setItem".split(" ").concat(N),ra={description:"",driver:G.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",
version:1};G=new (function(){function a(b){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");for(var c in H)if(H.hasOwnProperty(c)){var f=H[c],d=f._driver;this[c]=d;K[d]||this.defineDriver(f)}this._defaultConfig=U({},ra);this._config=U({},this._defaultConfig,b);this._initDriver=this._driverSet=null;this._ready=!1;this._dbInfo=null;this._wrapLibraryMethodsWithReady();this.setDriver(this._config.driver).catch(function(){})}return a.prototype.config=function(a){if("object"===
(void 0===a?"undefined":oa(a))){if(this._ready)return Error("Can't call config() after localforage has been used.");for(var b in a){if("storeName"===b&&(a[b]=a[b].replace(/\W/g,"_")),"version"===b&&"number"!=typeof a[b])return Error("Database version must be a number.");this._config[b]=a[b]}return!("driver"in a&&a.driver)||this.setDriver(this._config.driver)}return"string"==typeof a?this._config[a]:this._config},a.prototype.defineDriver=function(a,b,c){var d=new p(function(b,c){try{var d=a._driver,
f=Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!a._driver)return void c(f);for(var h=W.concat("_initStorage"),g=0,l=h.length;g<l;g++){var m=h[g];if((!qa(N,m)||a[m])&&"function"!=typeof a[m])return void c(f)}(function(){for(var b=function(a){return function(){var b=p.reject(Error("Method "+a+" is not implemented by the current driver"));return k(b,arguments[arguments.length-1]),b}},c=0,d=N.length;c<d;c++){var f=N[c];a[f]||(a[f]=b(f))}})();f=function(c){K[d]&&
console.info("Redefining LocalForage driver: "+d);K[d]=a;ja[d]=c;b()};"_support"in a?a._support&&"function"==typeof a._support?a._support().then(f,c):f(!!a._support):f(!0)}catch(T){c(T)}});return t(d,b,c),d},a.prototype.driver=function(){return this._driver||null},a.prototype.getDriver=function(a,b,c){a=K[a]?p.resolve(K[a]):p.reject(Error("Driver not found."));return t(a,b,c),a},a.prototype.getSerializer=function(a){var b=p.resolve(V);return t(b,a),b},a.prototype.ready=function(a){var b=this,c=b._driverSet.then(function(){return null===
b._ready&&(b._ready=b._initDriver()),b._ready});return t(c,a,a),c},a.prototype.setDriver=function(a,b,c){function d(){g._config.driver=g.driver()}function f(a){return g._extend(a),d(),g._ready=g._initStorage(g._config),g._ready}function h(a){return function(){function b(){for(;c<a.length;){var h=a[c];return c++,g._dbInfo=null,g._ready=null,g.getDriver(h).then(f).catch(b)}d();return g._driverSet=p.reject(Error("No available storage method found.")),g._driverSet}var c=0;return b()}}var g=this;fa(a)||
(a=[a]);var k=this._getSupportedDrivers(a);return this._driverSet=(null!==this._driverSet?this._driverSet.catch(function(){return p.resolve()}):p.resolve()).then(function(){var a=k[0];return g._dbInfo=null,g._ready=null,g.getDriver(a).then(function(a){g._driver=a._driver;d();g._wrapLibraryMethodsWithReady();g._initDriver=h(k)})}).catch(function(){d();return g._driverSet=p.reject(Error("No available storage method found.")),g._driverSet}),t(this._driverSet,b,c),this._driverSet},a.prototype.supports=
function(a){return!!ja[a]},a.prototype._extend=function(a){U(this,a)},a.prototype._getSupportedDrivers=function(a){for(var b=[],c=0,d=a.length;c<d;c++){var f=a[c];this.supports(f)&&b.push(f)}return b},a.prototype._wrapLibraryMethodsWithReady=function(){for(var a=0,b=W.length;a<b;a++)na(this,W[a])},a.prototype.createInstance=function(b){return new a(b)},a}());d.exports=G},{3:3}]},{},[4])(4)});
let dbrStoreConsumption,dbrStoreLicenseInfo,dbrBSendSmallRecordsForDebug,dbrSessionDuration,dbrNextPostConsumptionTime=-Infinity,dbrNextTaskId=0,dbrTaskCallbackMap=new Map,dbrAESGCMKey,dbrFuncGenAESGCMKey=()=>self.crypto.subtle.importKey("raw",new Uint8Array([80,88,27,82,145,164,199,211,187,87,89,128,150,44,190,213,99,181,118,158,215,103,76,117,29,83,122,137,5,180,157,114]),"AES-GCM",!0,["encrypt","decrypt"]),dbrFuncDecryptAndAtob=e=>$jscomp.asyncExecutePromiseGeneratorFunction(function*(){if(self.crypto&&
self.crypto.subtle&&self.crypto.subtle.importKey){var a=atob(e),d=new Uint8Array(a.length);for(let e=0;e<a.length;++e)d[e]=a.charCodeAt(e);a=d.subarray(0,12);d=d.subarray(a.length);if(!dbrAESGCMKey)try{dbrAESGCMKey=yield dbrFuncGenAESGCMKey()}catch(m){console.log(m)}d=yield self.crypto.subtle.decrypt({name:"AES-GCM",iv:a,tagLength:128},dbrAESGCMKey,d);return String.fromCharCode.apply(null,new Uint8Array(d))}return yield new Promise((a,d)=>{let k=dbrNextTaskId++;dbrTaskCallbackMap.set(k,e=>{if(e.success)return dbrBWasmDebug&&
console.log(e.txt),a(e.txt);{let a=Error(e.message);a.stack+="\n"+e.stack;return d(a)}});parentPort.postMessage({type:"taskd",taskID:k,txt:e})})}),dbrFuncEncryptAndBtoa=e=>$jscomp.asyncExecutePromiseGeneratorFunction(function*(){if(self.crypto&&self.crypto.subtle&&self.crypto.subtle.importKey){var a=new Uint8Array(e.length);for(var d=0;d<e.length;++d)a[d]=e.charCodeAt(d);d=self.crypto.getRandomValues(new Uint8Array(12));dbrAESGCMKey||(dbrAESGCMKey=yield dbrFuncGenAESGCMKey());a=yield self.crypto.subtle.encrypt({name:"AES-GCM",
iv:d,tagLength:128},dbrAESGCMKey,a);a=new Uint8Array(a);let m=new Uint8Array(d.length+a.length);m.set(d);m.set(a,d.length);return btoa(String.fromCharCode.apply(null,m))}return yield new Promise((a,d)=>{let k=dbrNextTaskId++;dbrTaskCallbackMap.set(k,e=>{if(e.success)return dbrBWasmDebug&&console.log(e.txt),a(e.txt);{let a=Error(e.message);a.stack+="\n"+e.stack;return d(a)}});parentPort.postMessage({type:"taske",taskID:k,txt:e})})});
var Module={locateFile:function(e){return"libDynamsoftBarcodeReader.wasm"==e?dbrBNode?dbrEngineResourcePath+"dbr-"+dbrVersion+".node.wasm":dbrEngineResourcePath+"dbr-"+dbrVersion+(dbrBUseFullFeature?".full":"")+".wasm":dbrEngineResourcePath+e},printErr:console.error,onRuntimeInitialized:function(){return $jscomp.asyncExecutePromiseGeneratorFunction(function*(){parentPort.postMessage({type:"log",message:"wasm initialized"});let e={productKeys:dbrProductKeys,domain:dbrDomain};dbrBWasmDebug&&(e.bDebug=
!0);if(dbrBRuntimeKeys){yield dbrPromiseGetLicense;let a=dbrLicenseInfo;if(a instanceof Error){parentPort.postMessage({type:"load",success:!1,message:a.message,stack:a.stack});setTimeout(()=>{throw a;},0);return}if(!a.productKeys){parentPort.postMessage({type:"load",success:!1,message:a.message,stack:""});return}dbrSessionDuration=1E3*a.sessionDuration;e.runtimeKeys=dbrProductKeys;e.productKeys=a.productKeys;e.consumeType=a.consumeType;e.urlGetLicense="";e.aryUrlPostConsume=e.sm_aryUrlPostConsume=
[];e.bNewDevice=dbrBNewDevice;e.uuid=dbrUUID;e.initTime=Date.now().toString();sendConsume();setInterval(sendConsume,dbrSessionDuration)}Module.BarcodeReaderWasm.init(JSON.stringify(e));parentPort.postMessage({type:"load",success:!0,version:Module.BarcodeReaderWasm.getVersion()})})}};let DBR_MapInstances=new Map,nextInstanceID=0;
parentPort.onmessage=function(e){return $jscomp.asyncExecutePromiseGeneratorFunction(function*(){var a=e.data?e.data:e,d=a.id,m=a.instanceID;const l=a.body;switch(a.type){case "loadWasm":dbrBWasmDebug=a.bWasmDebug;dbrEngineResourcePath=a.engineResourcePath;dbrVersion=a.version;dbrProductKeys=a.productKeys;dbrDomain=a.domain;dbrBUseFullFeature=a.bUseFullFeature;dbrUUID=a.uuid;dbrLicenseServer=a.licenseServer?a.licenseServer:dbrLicenseServer;dbrBSendSmallRecordsForDebug=a.bSendSmallRecordsForDebug;
if(dbrBNode){a=Module;Module=require("./dbr-"+dbrVersion+".node.wasm.js");for(let c in a)Module[c]=a[c]}else importScripts(dbrEngineResourcePath+"dbr-"+dbrVersion+(dbrBUseFullFeature?".full":"")+".wasm.js");(dbrBRuntimeKeys=8==dbrProductKeys.length)&&(dbrPromiseGetLicense=(()=>$jscomp.asyncExecutePromiseGeneratorFunction(function*(){try{yield(yield localforage.createInstance({name:"dbrjshello"})).setItem("dbrjshello","available")}catch(r){localforage=function(a){this.dbname=a};localforage.createInstance=
function(a){return $jscomp.asyncExecutePromiseGeneratorFunction(function*(){return new localforage(a.name)})};var a=a=>function(){let c=[];for(let a=0;a<arguments.length;++a)c.push(arguments[a]);return new Promise((d,e)=>{let h=dbrNextTaskId++;dbrTaskCallbackMap.set(h,a=>{if(a.success)return dbrBWasmDebug&&console.log(a.result),d(a.result);{let c=Error(a.message);c.stack+="\n"+a.stack;return e(c)}});parentPort.postMessage({type:"localforage",taskID:h,dbname:this.dbname,method:a,paras:c})})};localforage.prototype.setItem=
a("setItem");localforage.prototype.getItem=a("getItem");localforage.prototype.removeItem=a("removeItem");localforage.prototype.keys=a("keys")}dbrStoreLicenseInfo=yield localforage.createInstance({name:"dbrjsLicenseInfo"});dbrStoreConsumption=yield localforage.createInstance({name:"dbrjs"+dbrProductKeys+"unsV2"});dbrBNewDevice=!(yield dbrStoreLicenseInfo.getItem(dbrProductKeys+"old"));let d;if(a=yield dbrStoreLicenseInfo.getItem(dbrProductKeys))[a,d]=a,Date.now()>a&&(yield dbrStoreLicenseInfo.removeItem(dbrProductKeys),
d=null);try{yield Promise.race([fetch(dbrLicenseServer+"api/verification/"+dbrProductKeys).then(a=>{if(a.ok)return a.text();throw Error("Network Error. Can't get license.");}).then(a=>{d=a;return dbrStoreLicenseInfo.setItem(dbrProductKeys,[Date.now()+6048E5,d])}),new Promise((a,c)=>{setTimeout(()=>c(Error("Network Error. Request timeout.")),d?3E3:15E3)})])}catch(r){if(dbrBWasmDebug&&console.error(r),null==d){dbrLicenseInfo=r;return}}dbrLicenseInfo=yield dbrFuncDecryptAndAtob(d).then(a=>JSON.parse(a)).catch(()=>
Error("Parse Error. Can't get valid license."))}))());break;case "createInstance":m=nextInstanceID++;try{let c=new Module.BarcodeReaderWasm(a.bScanner,m);DBR_MapInstances.set(m,c);let d=JSON.parse(c.getRuntimeSettings());a.bScanner?(d.localizationModes=[2,0,0,0,0,0,0,0],d.deblurLevel=3):d.expectedBarcodesCount=999;dbrBNode||dbrBUseFullFeature||(d.barcodeFormatIds=234883071);c.updateRuntimeSettings(JSON.stringify(d))}catch(c){handleErr(c,d);break}parentPort.postMessage({type:"task",id:d,body:{success:!0,
instanceID:m}});break;case "destroy":try{DBR_MapInstances.get(m).delete(),DBR_MapInstances.delete(m)}catch(c){handleErr(c,d);break}parentPort.postMessage({type:"task",id:d,body:{success:!0}});break;case "decodeBuffer":{let a;try{a=JSON.parse(DBR_MapInstances.get(m).decodeBuffer(l.buffer,l.width,l.height,l.stride,l.format))}catch(h){handleErr(h,d);break}parentPort.postMessage({type:"task",id:d,body:{success:!0,decodeReturn:a}});break}case "decodeFileInMemory":{let a;try{a=JSON.parse(DBR_MapInstances.get(m).decodeFileInMemory(l.bytes))}catch(h){handleErr(h,
d);break}parentPort.postMessage({type:"task",id:d,body:{success:!0,decodeReturn:a}});break}case "getRuntimeSettings":{let a;try{a=DBR_MapInstances.get(m).getRuntimeSettings()}catch(h){handleErr(h,d);break}parentPort.postMessage({type:"task",id:d,body:{success:!0,results:a}});break}case "updateRuntimeSettings":{let a;try{a=JSON.parse(DBR_MapInstances.get(m).updateRuntimeSettings(l.settings))}catch(h){handleErr(h,d);break}parentPort.postMessage({type:"task",id:d,body:{success:!0,updateReturn:a}});break}case "resetRuntimeSettings":try{let c=
DBR_MapInstances.get(m);c.resetRuntimeSettings();let d=JSON.parse(c.getRuntimeSettings());a.bScanner?(d.localizationModes=[2,0,0,0,0,0,0,0],d.deblurLevel=3):d.expectedBarcodesCount=999;dbrBUseFullFeature||(d.barcodeFormatIds=234883071);c.updateRuntimeSettings(JSON.stringify(d))}catch(c){handleErr(e,d);break}parentPort.postMessage({type:"task",id:d,body:{success:!0}});break;case "outputSettingsToString":{let a;try{a=DBR_MapInstances.get(m).outputSettingsToString()}catch(h){handleErr(h,d);break}parentPort.postMessage({type:"task",
id:d,body:{success:!0,results:a}});break}case "initRuntimeSettingsWithString":{let a;try{a=JSON.parse(DBR_MapInstances.get(m).initRuntimeSettingsWithString(l.settings))}catch(h){handleErr(h,d);break}parentPort.postMessage({type:"task",id:d,body:{success:!0,initReturn:a}});break}case "getIntermediateResults":{let a=null;try{var k=DBR_MapInstances.get(m).getIntermediateResults(),t=JSON.parse(k,(c,d)=>"bytes"===c&&"ptr"in d&&"length"in d?a=Module.BarcodeReaderWasm.getBytes(d.ptr,d.length):d);DBR_MapInstances.get(m).freeIntermediateResults()}catch(h){handleErr(h,
d);break}parentPort.postMessage({type:"task",id:d,body:{success:!0,results:t}});break}case "setModeArgument":{let a;try{a=JSON.parse(DBR_MapInstances.get(m).setModeArgument(l.modeName,l.index,l.argumentName,l.argumentValue))}catch(h){handleErr(h,d);break}parentPort.postMessage({type:"task",id:d,body:{success:!0,setReturn:a}});break}case "updateScanSettings":try{let a=DBR_MapInstances.get(m),d=l.settings;a.duplicateForgetTime=d.duplicateForgetTime;a.oneDRememberFrameCount=d.oneDRememberFrameCount;
a.oneDTrustFrameCount=d.oneDTrustFrameCount;d.frameFilter?a.setFrameFilter(JSON.stringify(d.frameFilter)):a.setFrameFilter("")}catch(c){handleErr(c,d);break}parentPort.postMessage({type:"task",id:d,body:{success:!0}});break;case "getScanSettings":a={};try{let c=DBR_MapInstances.get(m);a.duplicateForgetTime=c.duplicateForgetTime;a.oneDRememberFrameCount=c.oneDRememberFrameCount;a.oneDTrustFrameCount=c.oneDTrustFrameCount;let d=c.getFrameFilter();d&&(a.frameFilter=JSON.parse(d))}catch(c){handleErr(c,
d);break}parentPort.postMessage({type:"task",id:d,body:{success:!0,results:a}});break;case "task":d=a.id;a=a.body;try{dbrTaskCallbackMap.get(d)(a),dbrTaskCallbackMap.delete(d)}catch(c){throw dbrTaskCallbackMap.delete(d),c;}break;default:console.warn("Unmatched task: ",e)}})};if(dbrBNode)parentPort.on("message",parentPort.onmessage);
let handleErr=(e,a)=>{parentPort.postMessage({type:"task",id:a,body:{success:!1,message:e.message,stack:e.stack}});setTimeout(()=>{throw e;},0)},addConsumeRecordToDB=e=>$jscomp.asyncExecutePromiseGeneratorFunction(function*(){dbrBWasmDebug&&console.log("%c","color:#0f0",atob(e));yield dbrStoreConsumption.setItem(Date.now().toString(),e);dbrNextPostConsumptionTime<Date.now()&&(dbrNextPostConsumptionTime=Date.now()+dbrSessionDuration,sendConsume())}),sendConsume=()=>$jscomp.asyncExecutePromiseGeneratorFunction(function*(){dbrPromisePostConsumption=
dbrPromisePostConsumption.then(()=>$jscomp.asyncExecutePromiseGeneratorFunction(function*(){var e=Date.now();let a=yield dbrStoreConsumption.keys();if(a.length){dbrBWasmDebug&&console.log("get keys to filter for send: %o",a);var d=[],m=new Map;for(let k of a){let a=JSON.parse(atob(yield dbrStoreConsumption.getItem(k))),c;dbrBNewDevice?(dbrBNewDevice=!1,yield dbrStoreLicenseInfo.setItem(dbrProductKeys+"old",dbrUUID),c=Math.floor(a.decodeTime/dbrSessionDuration)*dbrSessionDuration):c=Math.ceil(a.decodeTime/
dbrSessionDuration)*dbrSessionDuration;dbrBSendSmallRecordsForDebug&&(c=parseInt(a.decodeTime));dbrBWasmDebug&&console.log("timeKey: %d, dateNow: %d",c,e);if(c>e)continue;d.push(k);let h=m.has(c)?m.get(c):{all:0,oned:0,qr:0,pdf417:0,dm:0,mc:0,other:0};h.all+=a.consumption.all;h.oned+=a.consumption.oned;h.qr+=a.consumption.qr;h.pdf417+=a.consumption.pdf417;h.dm+=a.consumption.dm;h.mc+=a.consumption.mc;h.other+=a.consumption.other;m.set(c,h)}if(d.length){dbrBWasmDebug&&console.log("get keys for send: %o",
a);dbrNextPostConsumptionTime=e+dbrSessionDuration;var l=[];m.forEach((a,d)=>{l.push({recordTime:d,consumption:a})});e={version:"2",runtimeKeys:dbrProductKeys,uuid:dbrUUID,postTime:Date.now(),records:l};dbrBWasmDebug&&dbrBWasmDebug&&console.log(e);yield fetch(dbrLicenseServer+"api/verification",{mode:"cors",method:"POST",body:yield dbrFuncEncryptAndBtoa(JSON.stringify(e))}).then(a=>$jscomp.asyncExecutePromiseGeneratorFunction(function*(){if(a.ok)for(let a of d)yield dbrStoreConsumption.removeItem(a)}),
a=>{console.error(a)})}}}))});
